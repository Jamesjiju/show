<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Insert title here</title>
<style type="text/css">
	body>div{
		width: 700px;
		height: 600px;
		margin: 0 auto;
		border: 8px solid green;
		margin-top: 100px;
		border-radius: 10px; 
		background-color: rgba(0,0,0,0.3);
	}
	span{
		background-color: green;
		color: red;
	}
	.c1{
		padding-left: 85px;
		margin-left: 210px;
		margin-top: 10px;
	}
	.c2{
		margin-left: 200px;
	}
	#c2{
		margin-left: 200px;
	}
	input[type='submit']{
		margin-left: 20px;
	}
	input[type='button']{
		margin-left: 20px;
	}
	#province{
		width: 100px;
  		height: 20px;
	}
	#city{
		width: 100px;
  		height: 20px;
	}
	#area{
		width: 100px;
  		height: 20px;
	}
	.img-responsive{
		width: 20px;
		height: 30px;
	}
</style>
</head>
<body>
<div>
	<h1 class="c1">商品图片信息录入</h1><br>
	<form id="form-reg">
		<div class="c2">
		商品名称： <input type="text" placeholder="请输入商品名称" name="title"><br><br>
		图片价格：&nbsp;&nbsp;&nbsp;&nbsp;<input type="text" placeholder="请输入单张图片价格" name="price"><br><br>
		意向投放地点:<br>
		省/直辖市：<select id="province" name="province"></select><br><br>
		城市：&nbsp;&nbsp;<select id="city" name="city"></select><br><br>
		区县：&nbsp;&nbsp;<select id="area" name="area"></select><br><br>
		投放网吧名称：<input type="text" placeholder="请输入要投放的网吧名称" name="out_cus_name"><br><br>
		投放网管名称：<input type="text" placeholder="请输入要投放的网管名称" name="out_per_name"><br><br>
		</div>
		<p id="c2">
<!-- 		onclick="location='uploadPicture.html'" -->
			<input id="btn-reg" type="button" value="保存">
			<input id="look" type="button" value="图片预览" onclick="location='search.html'">
			<input id="" type="button" value="查看收益" onclick="location='showMoney.html'">
			<input id="changePrice" type="button" value="修改图片价格">
		</p>
	</form>
</div>
<script type="text/javascript" src="../js/jquery-1.4.2.js"></script>
<script type="text/javascript">
	$("#btn-reg").click(function(){
		$.ajax({
			"url" : "/pictures/addPicture",
			"data" : $("#form-reg").serialize(),
			"type" : "POST",
			"dataType" : "json",
			"success" : function(json){
				if(json.state == 200){
					alert("保存成功！");
					location.href = "uploadPicture.html?title=" + json.data;
				}else{
					alert(json.message);
				}
			}
		});
	});
	
	$("#changePrice").click(function(){
		$.ajax({
			"url" : "/pictures/changePrice",
			"data" : $("#form-reg").serialize(),
			"type" : "POST",
			"dataType" : "json",
			"success" : function(json){
				if(json.state == 200){
					alert("修改成功！");
				}else{
					alert(json.message);
				}
			}
		});
	});
</script>
<script type="text/javascript">
	$(document).ready(function() {
		showProvinceList();
		$("#province").change(function(){
			$("#city").empty();
			showCitysList();
			$("#area").empty();
			$("#area").append('<option value="0">---- 请选择 ----</option>');
		})
		$("#city").change(function(){
			$("#area").empty();
			showAreasList();
		})
		$("#city").append('<option value="0">---- 请选择 ----</option>');
		$("#area").append('<option value="0">---- 请选择 ----</option>');
	});
	
	function showProvinceList() {
		$("#province").append('<option value="0">---- 请选择 ----</option>');
		$.ajax({
			"url" : "/area/findProvince",
			"data" : "parent=86",
			"type" : "get",
			"dataType" : "json",
			"success" : function(json) {
				if (json.state == 200) {
					var list = json.data;
					for (var i = 0; i < list.length; i++) {
// 						console.log(list[i].name);
						var op = '<option value="'+list[i].code+'">'+list[i].name+'</option>';
						$("#province").append(op);
					}
				} else {
					//修改错误
					alert(json.message);
				}
			},
			"error" : function() {
				alert("您的登录信息以过期，请重新登录！");
				location.href = "/web/login.html";
			}
		});
	};
	
	function showCitysList() {
		var provinceCode = $("#province").val();
		$("#city").append('<option value="0">---- 请选择 ----</option>');
		if(provinceCode == 0){
			return;
		}
		$.ajax({
			"url" : "/area/findCity",
			"data" : "parent=" + provinceCode,
			"type" : "get",
			"dataType" : "json",
			"success" : function(json) {
				if (json.state == 200) {
					var list = json.data;
					for (var i = 0; i < list.length; i++) {
// 						console.log(list[i].name);
						var op = '<option value="' + list[i].code+'">' + list[i].name + '</option>';
						$("#city").append(op);
					}
				} else {
					//修改错误
					alert(json.message);
				}
			},
			"error" : function() {
				alert("您的登录信息以过期，请重新登录！");
				location.href = "/web/login.html";
			}
		});
	};
	
	function showAreasList() {
		var cityCode = $("#city").val();
		$("#area").append('<option value="0">---- 请选择 ----</option>');
		if(cityCode==0){
			return;
		}
		$.ajax({
			"url" : "/area/findArea",
			"data" : "parent=" + cityCode,
			"type" : "get",
			"dataType" : "json",
			"success" : function(json) {
				if (json.state == 200) {
					var list = json.data;
					for (var i = 0; i < list.length; i++) {
// 						console.log(list[i].name);
						var op = '<option value="'+list[i].code+'">'+list[i].name+'</option>';
						$("#area").append(op);
					}
				} else {
					//修改错误
					alert(json.message);
				}
			},
			"error" : function() {
				alert("您的登录信息以过期，请重新登录！");
				location.href = "/web/login.html";
			}
		});
	};
</script>
</body>
</html>